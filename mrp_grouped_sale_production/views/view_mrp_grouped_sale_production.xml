<?xml version="1.0" encoding="UTF-8"?>
<!--
Copyright (C) 2023 - Today: GRAP (http://www.grap.coop)
@author: Quentin DUPONT (quentin.dupont@grap.coop)
License AGPL-3.0 or later (http://www.gnu.org/licenses/agpl.html).
-->
<odoo>

    <record id="action_grouped_sale_2_wizard_x2m_matrix" model="ir.actions.act_window">
        <field name="name">Update Values</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">x2m.matrix.grouped.sales.wizard</field>
        <field name="view_type">form</field>
        <field name="view_mode">form</field>
        <field name="target">new</field>
    </record>

    <record id="action_grouped_sale_prod_2_sale_order" model="ir.actions.act_window">
        <field name="name">Sale Orders</field>
        <field name="res_model">sale.order</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
        <field name="domain">[('grouped_order_id', 'in', active_ids)]</field>
    </record>

    <record id="action_grouped_sale_prod_2_production_order" model="ir.actions.act_window">
        <field name="name">Production Orders</field>
        <field name="res_model">mrp.production</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
        <field name="domain">[('sale_order_id', 'in', active_ids)]</field>
    </record>

    <record id="view_grouped_sale_production_form" model="ir.ui.view">
        <field name="model">mrp.grouped.sale.production</field>
        <field name="arch" type="xml">
            <form>
                <header>
                  <button type="action" string="See and Update Values"
                          name="%(mrp_grouped_sale_production.action_grouped_sale_2_wizard_x2m_matrix)d"
                          icon="fa-edit"/>
                </header>
                <sheet>
                    <div class="oe_right oe_button_box" name="button_widget_sale_order">
                        <button class="oe_stat_button" type="action" icon="fa-list"
                            name="%(action_grouped_sale_prod_2_sale_order)d"
                            attrs="{'invisible': [('orders_qty', '=', 0)]}">
                            <field string="Sale Orders" name="orders_qty" widget="statinfo"/>
                        </button>
                        <button type="object"
                            name="action_view_production"
                            class="oe_stat_button"
                            icon="fa-gears"
                            attrs="{'invisible': [('mrp_production_qty', '=', 0)]}">
                            <field  string="Production Orders" name="mrp_production_qty" widget="statinfo"/>
                        </button>

                    </div>

                    <div class="oe_title">
                        <label for="name" class="oe_edit_only"/>
                        <h1><field name="name"/></h1>
                    </div>
                    <group>
                        <field name="notes"/>
                        <field name="production_date"/>
                    </group>
                    <group>
                        <field name="order_ids" nolabel="1"/>
                    </group>
                </sheet>
            </form>
        </field>
    </record>

    <record id="view_grouped_sale_production_tree" model="ir.ui.view">
        <field name="model">mrp.grouped.sale.production</field>
        <field name="arch" type="xml">
            <tree>
                <field name="name"/>
                <field name="production_date"/>
                <field name="orders_qty"/>
            </tree>
        </field>
    </record>

    <record id="action_grouped_sale_prod" model="ir.actions.act_window">
        <field name="name">Grouped Sale Production</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">mrp.grouped.sale.production</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
    </record>

    <menuitem id="menu_grouped_sale_prod"
        parent="mrp.menu_mrp_manufacturing" sequence="100"
        action="action_grouped_sale_prod"/>


</odoo>
